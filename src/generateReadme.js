import fs from "fs";
import path from "path";
import chalk from "chalk";

// ğŸ“Œ Function for Base README (Common Sections)
const baseReadme = (metadata, includeBadges) => {
  let content = `# ${metadata.name} ğŸš€  

> ${metadata.description}  

## ğŸ“Œ Table of Contents
if (includeBadges) {
- [ğŸ“– Overview](#-overview)
- [âš™ï¸ Installation](#-installation)
- [ğŸš€ Features](#-features)
- [ğŸ“‚ Project Structure](#-project-structure)
- [ğŸ’¡ Usage](#-usage)
- [ğŸ› ï¸ Tech Stack](#-tech-stack)
- [ğŸŒ Repository](#-repository)
- [ğŸ“œ License](#-license)
- [ğŸ”® Future Improvements](#-future-improvements)
- [â“ FAQ](#-faq)

`;

  if (includeBadges) {
    content += `## ğŸ† Badges  
![GitHub stars](https://img.shields.io/github/stars/${metadata.repository}.svg)  
![GitHub issues](https://img.shields.io/github/issues/${metadata.repository}.svg)  
![GitHub license](https://img.shields.io/github/license/${metadata.repository}.svg)  
![npm downloads](https://img.shields.io/npm/dt/${metadata.name}.svg)  

`;
  }

  content += `## ğŸ“– Overview  
${metadata.description}  

This project is designed to **solve XYZ problem** using **XYZ technology**. It is lightweight, highly customizable, and easy to set up.

## âš™ï¸ Installation  

\`\`\`sh
# Clone the repository
git clone ${metadata.repository || "<repository_url>"} my-project

# Navigate to the project directory
cd my-project

# Install dependencies
npm install

# Run the application
npm start
\`\`\`

> ğŸ“ **Note:** Ensure that **Node.js v14+** is installed before running this project.

---

## ğŸš€ Features  
âœ… Feature 1 - Description  
âœ… Feature 2 - Description  
âœ… Feature 3 - Description  
âœ… Feature 4 - Description  

---

## ğŸ“‚ Project Structure  

\`\`\`sh
my-project/
â”‚â”€â”€ src/               # Source code
â”‚   â”œâ”€â”€ components/    # UI Components
â”‚   â”œâ”€â”€ utils/         # Utility functions
â”‚   â”œâ”€â”€ api/           # API calls
â”‚â”€â”€ public/            # Static assets
â”‚â”€â”€ package.json       # Project metadata
â”‚â”€â”€ README.md          # Documentation
\`\`\`

> ğŸ’¡ **Tip:** Modify this structure based on your needs.

---

## ğŸ’¡ Usage  

\`\`\`sh
# Run in development mode
npm run dev

# Build for production
npm run build

# Run tests
npm test
\`\`\`

`;

  return content;
};

// ğŸ“Œ Function for Open Source README
const openSourceReadme = () => {
  return `## ğŸ¤ Contributing  
- Fork this repository  
- Clone it: \`git clone <repository_url>\`  
- Create a new branch and contribute!  

## ğŸ“œ Code of Conduct  
Please follow our [Code of Conduct](CODE_OF_CONDUCT.md).  

`;
};

// ğŸ“Œ Function for CLI Tool README
const cliToolReadme = (metadata) => {
  return `## âš™ï¸ CLI Commands  
\`\`\`sh
# Install globally
npm install -g ${metadata.name}

# Run the CLI tool
${metadata.name} --help
\`\`\`

`;
};

// ğŸ“Œ Function for API Docs README
const apiDocsReadme = () => {
  return `## ğŸ“Œ API Endpoints  
\`\`\`sh
GET /api/v1/users
POST /api/v1/auth/login
PUT /api/v1/users/:id
DELETE /api/v1/users/:id
\`\`\`

## ğŸ“œ API Documentation  
Refer to the [API Documentation](docs/api.md) for detailed usage and response formats.  

`;
};

// ğŸ“Œ Main function to generate README
const generateReadme = (metadata, includeBadges, templateType) => {
  let readmeContent = baseReadme(metadata, includeBadges);

  switch (templateType) {
    case "open-source":
      readmeContent += openSourceReadme();
      break;
    case "cli-tool":
      readmeContent += cliToolReadme(metadata);
      break;
    case "api-docs":
      readmeContent += apiDocsReadme();
      break;
    default:
      break; // Basic template already included
  }

  readmeContent += `## ğŸ› ï¸ Tech Stack  
ğŸ”¹ **Frontend:** React, Vue, or your choice  
ğŸ”¹ **Backend:** Node.js, Express  
ğŸ”¹ **Database:** MongoDB, PostgreSQL  
ğŸ”¹ **DevOps:** Docker, CI/CD  

---

## ğŸŒ Repository  
- **GitHub Repo**: ${metadata.repository}

## ğŸ“œ License  
This project is licensed under the **${metadata.license}** License.

---

## ğŸ”® Future Improvements  
- [ ] Feature 1  
- [ ] Feature 2  
- [ ] Improve performance  
- [ ] More integrations  

---

## â“ FAQ  

**Q: How do I customize this project?**  
A: Edit \`config.js\` or modify \`package.json\` settings.

**Q: Can I use this in production?**  
A: Absolutely! Follow best practices and security guidelines.

---

ğŸš€ **Generated by [AutoReadMe](https://github.com/your-repo-link)**  
`;

  const readmePath = path.resolve(process.cwd(), "README.md");
  fs.writeFileSync(readmePath, readmeContent, "utf-8");

  console.log(chalk.green(`âœ… README.md successfully created at ${readmePath}`));
};

export default generateReadme;
